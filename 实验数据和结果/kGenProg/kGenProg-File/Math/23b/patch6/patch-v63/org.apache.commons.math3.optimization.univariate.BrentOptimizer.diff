--- org.apache.commons.math3.optimization.univariate.BrentOptimizer
+++ org.apache.commons.math3.optimization.univariate.BrentOptimizer
@@ -268,6 +268,7 @@
                                Precision.equals(v, w)) {
                         v = u;
                         fv = fu;
+						r = e;
                     }
                 }
             } else { // Default termination (Brent's criterion).
