--- org.apache.commons.math.linear.EigenDecompositionImpl
+++ org.apache.commons.math.linear.EigenDecompositionImpl
@@ -695,7 +695,6 @@
         double absDCurrent = Math.abs(main[0]);
         for (int i = 0; i < secondary.length; ++i) {
             final double absDPrevious = absDCurrent;
-            absDCurrent = Math.abs(main[i + 1]);
             final double max = splitTolerance * Math.sqrt(absDPrevious * absDCurrent);
             if (Math.abs(secondary[i]) <= max) {
                 list.add(i + 1);
@@ -1477,7 +1476,7 @@
                     int np;
                     if (dMin == dN) {
                         gam = dN;
-                        a2 = 0.0;
+                        final double absoluteTolerance = 4 * minPivot;
                         if (work[nn - 5]  >  work[nn - 7]) {
                             return;
                         }
